





var flagcloseID="";
var flagcloseID2="";
var flagcloseID3="";
var flagcloseID4="";


var button_adv_reset_pause = 0;


var lang = new Array();
lang[1]= 'Произошла ошибка при формировании счета, повторите попытку позже';
lang[2]= 'Товар добавлен в корзину';
lang[3]= 'Товар уже добавлен в корзину';
lang[4]= 'руб.';
lang[5]= 'Для сравнения необходимо не менее';
lang[6]= 'Для сравнения вы можете выбрать до';
lang[7]= 'товаров';
lang[8]= 'Товар добавлен в избранное';
lang[9]= 'Укажите количество нужных товаров';
lang[10]= 'Укажите кол-во товара, добавляемого в корзину';
lang[11] = 'Выберите галочками нужные товары';
lang[12] = 'Вы действительно хотите удалить выбранные товары?';
lang[14] = 'Отправьте сообщение об ошибке';
lang[15] = 'Сообщение об ошибке отправлено';


var cur_baner = 1;
var intervalID;
var width = 744;
var speed = 1000;
var cnt_banner;




$(window).load(function(){
onReadyCommon();
});

function onReadyCommon(){

repeatList = setTimeout('void(0)',1);

 
$("input[name='add2fav'], input[name='del2fav']").live('click', function() {
var html = '', params = '';
var el = $(this);
var item = $(this).attr("value");
var cat = $(this).attr("size");
var div = 'div.' + $(this).parent().attr("class");

if (this.checked) {
params = "item=" + item + "&class=" + cat;
html = '<input type="checkbox" name="del2fav" value="' + item + '" size="' + cat + '" id="idf_' + item + '" checked />' + 
'<label for="idf_' + item + '">Удалить из избранных</label>&nbsp';
} else {
params = "item=" + item + "&class=" + cat + "&del=1";
html = '<input type="checkbox" id="idf_' + item + '" size="' + cat + '" value="' + item + '" name="add2fav">'+
'<label for="idf_' + item + '">Добавить в избранные</label>&nbsp';
}

$.ajax({
type: "POST",
data: params,
cashe: false,
url: '/aload/add2favorites/',
dataType: "json",
success: function(data){

if (data.error == 0) {

if (jQuery(div).length > 0) {

if (data.ctnCT > 0) {
html = html + "&nbsp" +'<a href="/myoffice/favorites/" target="_blank" class="t14_js_link_checkbox">Перейти к избранным</a>';
}

$(el).parent().html(html);
}
}
}
});
});





if ($('#slider').length > 0 || $('#slider_min').length > 0) {
var slider_id = ( $('#slider').length > 0 ) ? 'slider' : 'slider_min';
var cnt_banner = $('#' + slider_id + ' > li').length;
var cur_slide = 1;
var isLeftRight = 0;
var isCheckSlide = 0;
var direction;

if (cnt_banner > 1) {
$('#' + slider_id).anythingSlider({
startPanel: 0,
buildNavigation: false,
infiniteSlides: true,
hashTags: false,
pauseOnHover: true,
delay: 4000,
startStopped: false,
animationTime: 600,
buildArrows: false,
buildStartStop: false,
onSlideBegin: function() {

if (isLeftRight) {
slider.startStop(true);
isLeftRight = false;
return false;
}

$('#externalNav > li').each(function() {
$(this).attr('class', 't36_js_number_passiv');
});

if (isCheckSlide) {
isCheckSlide = false;
} else {
cur_slide++ ;
if (cur_slide > cnt_banner) {
cur_slide = 1;
}
isLeftRight = false;
}

$('.t36_link > a').attr('href', $('#slide_' + cur_slide + ' > a').attr('href'));
$('#bb' + cur_slide).addClass('t36_js_number_activ');
}
});

var slider = $('#' + slider_id).data('AnythingSlider');
slider.startStop(true);
$('.t36_link > a').attr('href', $('#slide_1 > a').attr('href'));

jQuery('.t36_js_on_left, .t36_js_on_right').hover (
function () {
jQuery(this).find('div').addClass('t36_js_play');
},
function () {
jQuery(this).find('div').removeClass('t36_js_play');
}
);

$('.t36_js_on_left, .t36_js_on_right').click(function(){
isLeftRight = true;
direction = ($(this).attr('class') === 't36_js_on_right') ? 'goForward' : 'goBack';

$('#externalNav > li').each(function() {
if ($(this).attr('class') == 't36_js_number_activ') {
cur_slide = $(this).attr('id').substring(2);
}
});

$('ul[id^=' + slider_id + ']').each(function(){
$(this).data('AnythingSlider')[direction]();
});

$('#externalNav > li').each(function() {
$(this).attr('class', 't36_js_number_passiv');
});

if (direction == 'goForward') {
cur_slide = parseInt(cur_slide) + 1;
if (cur_slide > cnt_banner) {
cur_slide = 1;
}
} else {
cur_slide = parseInt(cur_slide) - 1;
if (cur_slide == 0) {
cur_slide = cnt_banner;
}
}
$('#bb' + cur_slide).addClass('t36_js_number_activ');
$('.t36_link > a').attr('href', $('#slide_' + cur_slide + ' > a').attr('href'));
});

$('#externalNav > li').click(function(){
isLeftRight = false;
isCheckSlide = true;
cur_slide = $(this).attr('id').substring(2);
$('#' + slider_id).anythingSlider(cur_slide);
slider.startStop(false);
return false;
});
}
}




$("div.onsubmit").find("form").live("submit", function(){
return false;
});

$("input.newbuy").live("click", function(){
var nameForm2 = $(this).attr("id");
checkit(nameForm2);
return false;
});



$("div.js-showitemlist-buts").find("input").click(function(){
var flagCh=0;
$(this).parents("div.checkTable").find(":checkbox.action").each(function(){
if ( $(this).is(":checked") ) flagCh = 1;
});

var name_submit= $(this).attr("name");

 
if (flagCh == 0 && name_submit!='calculate') {
alert(lang[11]);
return false;
}
else {
switch (name_submit) {
case 'addbasket':
return true;
break;
case 'addfav':
return true;
break;
case 'calculate':
case 'deleteline':
return true;
break;
case 'delfav':
if (confirm (lang[12]) ) return true;
else return false;
break;
}
}
});


$("td.boxPack").click(function(){
var elemCh = $(this).parents("#HeaderPlayContainer").find("input[name='boxPack']");
checkedToggle(elemCh);
elemCh.click();
checkedToggle(elemCh);
});
$("input[name='boxPack']").click(function(){ 

if ($(this).is(":checked")){
var valPack = $(this).attr("value");
var xCount =$("#js-cardProduct").find(":text[@name^='count']").attr("value");
if (xCount == 0){
xCount = 1;
}

var diffCount = Math.ceil( xCount /valPack);
var resultCount = diffCount * valPack;
if (resultCount < valPack){
resultCount = valPack;
}


$("#js-cardProduct").find("input.countPack").attr("value", valPack);
$("#js-cardProduct").find(":text[@name^='count']").attr("value", resultCount);
packPrice ( $("#js-cardProduct").find("input.countfrom").get(0) );
}
else {
$(this).parents("#js-cardProduct").find("input.countPack").attr("value", 1);
packPrice ( $(this).parents("#js-cardProduct").find("input.countfrom").get(0) );
}
$(this).blur();
});


$("div.checkTableMini").find("td.LineJS:odd").attr("class","middBG_odd LineJS");


$("input.countfrom").live("change", function() {
selectedSum (this);
packPrice (this);
});


$("div.formItem div.arrowUp")
.live("mouseup", function(){ 
plusStop(this);
selectedSum (this);
packPrice (this);
})
.live("mousedown", function(){
arrowCalc(this, 1);
return false;
})
.live("mouseout", function(){ 
plusStop(this);
});


$("div.formItem div.arrowDown")
.live("mouseup", function(){ 
plusStop(this);
selectedSum (this);
packPrice (this);
})
.live("mousedown", function(){ 
arrowCalc(this, 2);
return false;
})
.live("mouseout", function(){ 
plusStop(this);
});


$("div.checkTable a.SPlus").click(function(){
calculeteSet(this, 1);
selectedSum (this);
return false;
});


$("div.checkTable a.SMin").click(function(){
calculeteSet(this, 2);
selectedSum (this);
return false;
});




$("div.checkTable").find("input[name='tuggle']").click(function(){
if ( $(this).is(":checked") ) {
$(this).parents("div.checkTable").find(":checkbox.action").each(function(){
if (!$(this).is(":disabled")){
this.checked = "checked";
$(this).parents("td.LineJS").attr("class","middBG_active LineJS");
}
});
$(this).parents("div.checkTable").find("input[name='tuggle']").attr("checked","checked");
}
else {
$(this).parents("div.checkTable").find(":checkbox.action").each(function(){
this.checked = "";
if ( $(this).parents("div.checkTableMini").parents("td.LineJS").is(":odd") ) {
 
}
else {
$(this).parents("td.LineJS").attr("class","middBG LineJS");
$("div.checkTableMini").find("td.LineJS:odd").attr("class","middBG_odd LineJS");
}
});
$(this).parents("div.checkTable").find("input[name='tuggle']").attr("checked","");
}

selectedSum (this);
});


$("td.LineJS td.click").click(function(){
if ( $(this).parents("td.LineJS").find(":checkbox.action").is(":checked") ){
$(this).parents("td.LineJS").find(":checkbox.action").attr("checked","");
varvarChTableMini = $(this).parents("div.checkTableMini").find("td.LineJS").index($(this).parents("td.LineJS"));

if ((parseInt(varChTableMini))%2==0 || varChTableMini == -1) {
 
$(this).parents("td.LineJS").attr("class","middBG LineJS");
}
else {
 
$(this).parents("td.LineJS").attr("class","middBG_odd LineJS");
}
}
else {
if (!$(this).parents("td.LineJS").find(":checkbox.action").is(":disabled")){
$(this).parents("td.LineJS").find(":checkbox.action").attr("checked","checked");
$(this).parents("td.LineJS").attr("class","middBG_active LineJS");
}
}

selectedSum (this);
});

$("td.LineJS td.ch_click").click(function(){
if ( $(this).parents("td.LineJS").find(":checkbox.action").is(":checked") ) {
if (!$(this).parents("td.LineJS").find(":checkbox.action").is(":disabled")){
$(this).parents("td.LineJS").find(":checkbox.action").attr("checked","checked");
$(this).parents("td.LineJS").attr("class","middBG_active LineJS");
}
}
else {
$(this).parents("td.LineJS").find(":checkbox.action").attr("checked","");
varvarChTableMini = $(this).parents("div.checkTableMini").find("td.LineJS").index($(this).parents("td.LineJS"));

if ((parseInt(varChTableMini))%2==0 || varChTableMini == -1) {
 
$(this).parents("td.LineJS").attr("class","middBG LineJS");
}
else {
 
$(this).parents("td.LineJS").attr("class","middBG_odd LineJS");
}
}
selectedSum (this);
});


$("#MainInfoContainer").find("div.ItemFavBlock").find("a.add").click(function(){ 
var myHref = $(this).attr("href");
var it = $(this).parent().parent();
Ajax("/aload/favorite_add/", "myHref=" + myHref, function(data, textStatus){
addFavResult (data, it);
});
return false;
});



if ($("#js-brand").size() > 0) {
 
$("#js-type").attr("disabled","disabled");
$("#js-printer").attr("disabled","disabled");
 
$("#js-brand :first").attr("selected", "selected");
$("#js-type :first").attr("selected", "selected");
$("#js-printer :first").attr("selected", "selected");
}
 
$("#js-brand").live("change", function(){
Ajax_Load_Search('brand')
} );
$("#js-type").live("change", function(){
Ajax_Load_Search('type')
} );
$("#js-printer").live("change", function(){
Ajax_Load_Search('printer')
} );

$("#js-printer-submit").live("click", function(){

_gaq.push(['_trackEvent','Podbor','consum_filter']);

var printer_value = $("#js-printer").val();
var p1 = $("#js-brand").val();
var p2 = $("#js-type").val();
if (printer_value){
window.location.hash = 'action_online_opros2012';
 
window.location = "http://www.komus.ru/consum/index/_s/relID/" + printer_value + "/p1/" + p1 + "/p2/" + p2 + "/";
}
});


var tdsm;
var tdsm_color;
$("table.stdTable td").live({
mouseover: function(){
tdsm = $(this).parent().find("td");
tdsm_color = $(this).attr("class");
tdsm.css({
"background":"#fcfce2"
});
},
mouseout: function(){
if (tdsm_color == 'odd'){
tdsm.css({
"background":"#F6F6F6"
});
}
else {
tdsm.css({
"background":"none"
});
}
}
});



$(".close-spry-menu").live("click", function(){
$("#MenuBar1").find("a.MenuBarItemSubmenuHover").removeClass("MenuBarItemSubmenuHover");
$("#MenuBar1").find("ul.MenuBarSubmenuVisible").removeClass("MenuBarSubmenuVisible");
return false;
});

$("#MenuBar1").find(".menuscroll").hover(
function(){
var hei_scrW = $('html,body').scrollTop();
var hei_browser = screenHeight();
var hei_el = $(this).height();
var y_el = $(this).offset().top;
var hei_sum = hei_el + y_el - hei_scrW;
var hei_target = hei_sum - hei_browser + 32 + hei_scrW;

opentime2 = window.setTimeout(function(){
if (hei_browser < hei_sum) {
myScrollH(hei_target);
}
}, 200);
},
function(){
clearTimeout(opentime2);
});


$("a.PreLoadMenu").hover(function(){
var smenuID = $(this).attr("id");
smenuIDsub = smenuID.substr(5);
if (smenuID != "sload" + smenuIDsub){
var smenuOptions = {
xx: 0,
ID: smenuIDsub
};
$('script[type="text/x-jquery-tmpl"]').tmpl(smenu, smenuOptions).appendTo($('#div'+smenuID).empty());
$(this).attr("id", "sload" + smenuIDsub);
}
},
function(){});



$("a.help_word_book").click(function(){
var aID = $(this).attr("title");
$(this).before("<div style='position:absolute; top:-12px; border: 1px solid gray;' id='word"+ aID +"'></div>");
$("#word"+aID).load("/ajax/word_book.php", {
ID: aID
});
$(this).attr("class","help_word_book_del");
return false;
});


$("#search-example").click(function(){
var txt_ex = $(this).text();
$("#query_ac_main").attr("value", txt_ex);
});


if ( $('#featuresA').length ){
 
$("#AnalogsContainAll").show();
toggleAnalogsButton();
$("input:checkbox", $("#featuresA")).click(toggleAnalogsButton);

$("#AnalogsButton").children("input").click(function(){
var blk = $("input:checked", $("#featuresA")).serialize();
var catID = $(this).attr('name');
var str = $(this).attr('name');
var arr = str.split(':');
var params = "itemID=" + arr[1] + "&catID=" + arr[0] + "&" + blk;
$.ajax({
type: "POST",
data: params,
cashe: false,
url: '/compare/120',
success: function(data){
jQuery('#body-test-test').html(data);
jQuery("html,body").animate({
scrollTop: jQuery("body").offset().top
}, 1000);
}

});

});
}


$(".link-comp-select").live("click", function(){
var id_comp = $(this).attr("rel");
$("select[name=company_select]").val(id_comp);
$("#company_select_form").submit();
return false;
});
$("select[name=company_select]").change(function() {
this.form.submit();
});
$("#company_select_ok").hide();


$("#jq-panels-left")
.hover(
function () {
if ( $("#Jq-panel-actL").length ){
clearTimeout(flagcloseID2);
clearTimeout(flagcloseID);
}
else {
openPanels("L");

$("#Jq-panel-actL")
.hover(
function () {
clearTimeout(flagcloseID);
},
function () {
flagcloseID2 = setTimeout(function() {
closePanels("L");
} , 1000);
}
);
}
},
function () {
flagcloseID = setTimeout(function() {
closePanels("L");
} , 1000);
}
);

$("#jq-panels-right")
.hover(
function () {
if ( $("#Jq-panel-actR").length ){
clearTimeout(flagcloseID3);
clearTimeout(flagcloseID4);
}
else {
openPanels("R");

$("#Jq-panel-actR")
.hover(
function () {
clearTimeout(flagcloseID3);
},
function () {
flagcloseID4 = setTimeout(function() {
closePanels("R");
} , 1000);
}
);
}
},
function () {
flagcloseID3 = setTimeout(function() {
closePanels("R");
} , 1000);
}
);

$("#jq-panels-company").hover(
function () {
openPanelsComp(this);
},
function () {

var flagcloseID = setTimeout( function() {
closePanelsComp();
} , 1000);
$("#Jq-panel-actComp").hover(function () {
clearTimeout(flagcloseID);
},
function () {
closePanelsComp(this);
});
}
);


var adv_li = $('#advtopUl ul.bBut').find('img').length;
if (adv_li > 0){
adv_li = adv_li - 1;
window.sto_sib = setTimeout("autoPer(1, "+adv_li+")", 6000);
$("#sib_advtop2").attr("style", "display:block;");
$('#advtopUl ul.bBut').find('img').click(function(){
clearTimeout(window.sto_sib);
var path = $(this).parent().attr('href').substring(1,5);
var alt = $(this).attr('alt');
if (path == 's'){
$(this).attr('src','/img/autoper/number_play.jpg');
$(this).parent().attr('href','#p');
}
else if (path == 'p') {
var ind = button_adv_reset_pause + 1;
if (ind == adv_li) ind = 0;
window.sto_sib = setTimeout("autoPer("+ind+", "+adv_li+")", 1200);
$(this).attr('src','/img/autoper/number_pause.jpg');
$(this).parent().attr('href','#s');
$(this).attr('class','st');
}
else {
advClick (path, 200);
$('#advtopUl ul.bBut').find('img.st').attr('src','/img/autoper/number_play.jpg');
$('#advtopUl ul.bBut').find('img.st').parent().attr('href','#p');
$('#advtopUl ul.bBut').find('img.st').attr('class','st2');
}
$(this).parent().blur();
return false;
});
}


$(document).keypress(function (e) {

if($.support.cssFloat) {
var selected_text = document.getSelection();
} else {
var selected_text = document.selection.createRange().text;
}
selected_text = selected_text + "";

if ( (selected_text.length>1) && e.ctrlKey && ( 13 == e.which || 10 == e.which ) ) {

$("textarea.dialog_error").text(selected_text);

$("#dialog_error").dialog({
position: ["center","middle"],
modal: true,
title: lang[14],
width: 400,
close:function(event, ui) {
$(this).dialog("destroy");
},
buttons: {
OK: function() {
var textarea_dialog =encodeURIComponent ($("textarea.dialog_error").attr("value"));
var uri_er2 = encodeURIComponent ($("input[name='error_input']").attr("value"));
Ajax("/ajax/send_error.php", "text=" + textarea_dialog + "&uri=" + uri_er2, function(data, textStatus){
DialogResult();
});
}
}
});
}
});

 
$('#sel-items-all').live('click', function() {
if(!$(this).is(":checked")){
$(".sel-item").removeAttr("checked");
}
else{
$(".sel-item").attr("checked","checked");
}
});




$('.t111_js_table tbody tr:not(.formItem tr)').hover (
function () {
$(this).addClass('t111_js_tr_hover');
},
function () {
$(this).removeClass('t111_js_tr_hover');
}
);



$('.t111_js_table tbody td:not(.t111_js_td_nochecked), .t111_js_table tbody .t111_js_checkbox input:checkbox,.t111_js_table tbody .t111_js_radio input:radio').click (function () {
 
var t111_table = $(this).closest('.t111_js_table');
 
var t111_tr = $(this).closest('tr');
 
var t111_checkbox = t111_tr.find('.t111_js_checkbox input:checkbox');
 
var t111_radio = t111_tr.find('.t111_js_radio input:radio');

 
if (t111_checkbox.attr('type')=='checkbox') {
if (t111_checkbox.attr('checked')) {
t111_tr.removeClass('t111_js_tr_checked');
t111_checkbox.removeAttr('checked')
}
else {
t111_tr.addClass('t111_js_tr_checked');
t111_checkbox.attr('checked','checked')
};
} 
 
else if (t111_radio.attr('type')=='radio') {
t111_table.find('tbody tr').removeClass('t111_js_tr_checked');
t111_tr.addClass('t111_js_tr_checked');
t111_radio.attr('checked','checked');
};
}
);



$('.t111_js_table td input, .t111_js_table td select').not('.t111_js_checkbox input:checkbox').focus (function () {
$(this).closest('tr').addClass('t111_js_tr_edit');
}).blur (function () {
$(this).closest('tr').removeClass('t111_js_tr_edit');
});



$('.t111_js_table .t111_js_all_checkbox input:checkbox').click (function () {
if (this.checked) { 
$(this).closest('.t111_js_table').find('tbody tr').addClass('t111_js_tr_checked');
$(this).closest('.t111_js_table').find('tbody .t111_js_checkbox input:checkbox').attr('checked','checked');
}
else {
$(this).closest('.t111_js_table').find('tbody tr').removeClass('t111_js_tr_checked'); 
$(this).closest('.t111_js_table').find('tbody .t111_js_checkbox input:checkbox').removeAttr('checked');
}
}
);








 
$(".js_form_whith_comments .js_comment_input_textarea").each(function(){
if ($(this).attr("value") == ""||$(this).attr("value") == $(this).attr("title")) {
$(this).attr("value", $(this).attr("title"));
$(this).addClass('t0_silver_text');
};
});
 
$(".js_form_whith_comments .js_comment_input_textarea").focus(function(){
if ($(this).attr("value") == $(this).attr("title")) {
$(this).attr("value", "");
$(this).removeClass('t0_silver_text');
};
});
 
$(".js_form_whith_comments .js_comment_input_textarea").blur(function(){
if ($(this).attr("value") == "") {
$(this).attr("value", $(this).attr("title"));
$(this).addClass('t0_silver_text');
};
});
 
$(".js_comment_select").each(function(){
if (!$(this).attr("value")) {
$(this).addClass('t0_silver_text');
};
});
 
$(".js_comment_select").change(function(){
if ($(this).attr("value")) {
$(this).removeClass('t0_silver_text');
}
else {
$(this).addClass('t0_silver_text');
};
});
 
$('form.js_form_whith_comments').submit(function(eventObject) {
$(".js_comment_input_textarea").each(function(){
if ($(this).attr("value") == $(this).attr("title")) {
$(this).attr("value", "");
};
});
});



}










function screenHeight(){
return $.browser.opera? window.innerHeight : $(window).height();
}


function Ajax(param_url, param_data, callback){

$.ajax({
type: "POST",
url: param_url,
data: param_data,
cashe: false,
dataType: "json",
beforeSend: function (){
$("body").css({
cursor:"wait"
});
$(".js-wait").css({
cursor:"wait"
});
},
success: function(data, textStatus){
callback(data, textStatus);
},
complete: function(data, textStatus){
$("body").css({
cursor:"auto"
});
$(".js-wait").css({
cursor:"auto"
});
}
});
}


function checkit(nameForm) {

var rest = 0;

formName = document.forms[nameForm];
count = formName.elements['count'];
itemID = formName.elements['itemID'];
typeID = formName.elements['typeID'];
catID = formName.elements['parentID'];

if (count.value > 0) {
rest = 1;
}
else {
alert(lang[10]);
}

if (rest == 1) {
var params = "count=" + count.value + "&itemID=" + itemID.value + "&catID=" + catID.value + "&typeID=" + typeID.value;

Ajax("/aload/cart_add/", params, function(data, textStatus){
addBasketResult (data);
$('body').trigger('add_cart', data);
});
}

$('body').trigger('gr_add_2_cart', '[{"itemID": "' + itemID.value + '","count": "' + count.value + '"}]');
return false;
}


function addBasketResult (ResObj) {

var tip = ResObj.typeID;
var plateDiv = "plateAj"+ResObj.itemID + tip;
var formDiv = "formAj"+ResObj.itemID + tip;
var blockDiv = "blockAj"+ResObj.itemID + tip;
var NBalansDiv = "NBalansAj"+ResObj.itemID + tip;

switch (ResObj.error) {
case 0:
if (ResObj.kch_flag == 1){
 
document.getElementById("kch_bsumm").innerHTML = ResObj.kch_balans;
document.getElementById("kch_basket_summ").innerHTML = ResObj.kch_bsumm;
 
document.getElementById("kch_bsumm_str").innerHTML = ResObj.kch_balans_str;
document.getElementById("kch_basket_summ_str").innerHTML = ResObj.kch_bsumm_str;
}

if (typeof _gaq !=="undefined"){
_gaq.push(['_trackEvent', 'put_in_basket', ResObj.cat_nm, ResObj.nm, ResObj.cost]);
}

document.getElementById("basketAjCountNum").innerHTML = ResObj.basket_count;
document.getElementById("basketAjSum").innerHTML = ResObj.basket_sum + ' ' + lang[4];

$("#"+formDiv).find("input:image").attr("onClick","");
$("#"+plateDiv).show("slow", function() {
setTimeout(function() {
$("#"+plateDiv).hide("slow", function() {
$("#"+formDiv).hide("slow", function() {
$("#"+blockDiv).find('a').find('img').attr('width', '70');
$("#"+blockDiv).show("slow", function() {

$('div.onsubmit').find('input.itemID[value="' + ResObj.itemID + '"]').each(function() {

$(this).closest('div.onsubmit').css({'display':'none'});

$(this).closest('div.formItem').find('.in_basket').css({'display':'block'});
});
});
});
});
}, 2000);
});
break;
case 1:
document.location.replace("http://www.komus.ru/nocookies/");
break;
case 2:
alert('error:2 ' + ResObj.itemID);
break;
case 3:
alert('error:3 ');
break;
case 4:
alert(lang[9] + ' error:4 ');
break;
case 5:// Комус-Шанс - ошибка недостаточно монет
$("#"+NBalansDiv).show("slow", function() {
setTimeout(function() {
$("#"+NBalansDiv).hide("slow", function() {
});
}, 2000);
});
break;
}
}


function selectedSum (sel){

var itogo = 0;
$(sel).parents("div.checkTable").find(":checkbox.action").each(function(){
if ( $(this).is(":checked") ) {
var count_tmp = $(this).parents("td.LineJS").find("input.countfrom").attr("value");
var sum_tmp =$(this).parents("td.LineJS").find("input.priceyour").attr("value");
itogo = itogo + ( count_tmp * sum_tmp );
}
});
itogo = itogo / 100;
$(sel).parents("div.checkTable").find("#buttonsBlock").text(itogo + " п╒.");
}


function plusStop(el) {
if (repeatList > 0) clearTimeout(repeatList);
}


function packPrice (el){

var pack_qty = $(el).parents("div.formItem").find("input.pack_qty").attr("value");
var count_val = $(el).parents("div.formItem").find("input.countfrom").attr("value");
var tip = $(el).parents("div.formItem").find("input.typeID").attr("value");
var item = $(el).parents("div.formItem").find("input.itemID").attr("value");

if (pack_qty > 1) {
$("#Price" + item + tip).load("/ajax/pricePack.php", "pack_qty=" + pack_qty + "&itemID=" + item + "&count=" + count_val );
}
}


function calculateList(tip, elCount) {

var count_val = elCount.attr("value");
 
var countPack = $(elCount).parents("div.formItem").find("input.countPack").attr("value");

if ( parseInt(countPack) > 1) {
var countPackVal = parseInt(countPack);
} else {
var countPackVal = 1;
}

if (tip==1){
var count_val_plus = parseInt(count_val) + countPackVal;
repeatList=setTimeout('calculateList(1, elCount)',222);
if (count_val_plus>0) {
$(elCount).attr("value", count_val_plus);
} else {
$(elCount).attr("value", countPackVal);
}
}
else if (tip==2){
var count_val_min = parseInt(count_val) - countPackVal;
repeatList=setTimeout('calculateList(2, elCount)',222);
if (count_val_min>countPackVal - 1) {
$(elCount).attr("value", count_val_min);
} else {
$(elCount).attr("value", countPackVal);
}
}
}


function addFavResult (ResObj, it) {

switch (ResObj.error) {
case 0:
$(it).after('<div style="position: absolute;"><div class="plateAjaxFav"><img src="/img/emp.gif" width="140" height="20" alt="" border="0"></div></div>');
$(it).next().children().show("slow", function() {
setTimeout(function() {
$(it).next().children().hide("slow");
}, 2000);
});
$(it).children("span:first").hide();
$(it).children("span:first").next().show('');
break;
case 1:
document.location.replace("http://www.komus.ru/nocookies/");
break;
case 3:
alert('error =3 ');
break;
case 4:
alert(lang[9]);
break;
}
}


function myScrollH (targetOffset){
$('html,body').animate({
"scrollTop": targetOffset
}, 1000);
}


function checkedToggle (elem){
if ($(elem).is(":checked")) $(elem).attr('checked',''); else $(elem).attr('checked','checked');
}


function arrowCalc(element, type){
var countPack = 1;
if ($(':checkbox[name=boxPack]').attr('checked')) {
var countPack = $(":checkbox[name=boxPack]:checked").val();
}
elCount = $(element).parents("div.formItem").find(":text[@name^='count']");
var count_val = elCount.attr("value");
 
if ( parseInt(countPack) > 1) {
var countPackVal = parseInt(countPack);
} else {
var countPackVal = 1;
}
if (type == 1){
var count_val_t = countPackVal + parseInt(count_val);
if (count_val_t>0) {
$(elCount).attr("value", count_val_t);
} else {
$(elCount).attr("value", countPackVal);
}
}
else {
var count_val_t = parseInt(count_val) - countPackVal;
if (count_val_t>countPackVal - 1) {
$(elCount).attr("value", count_val_t);
} else {
$(elCount).attr("value", countPackVal);
}
}
repeatList = setTimeout('calculateList('+ type +',elCount)',222);
}


function calculeteSet(element, type){
var SVal_prev = $(element).parents("td.BlockBack").find("div.SVal").text();
if (type == 1){
var SVal = ( SVal_prev * 1 ) + 1;
if (SVal == 51) SVal = 50;
}
else {
var SVal = ( SVal_prev * 1 ) - 1;
if (SVal == 0) SVal = 1;
}

$(element).parents("td.BlockBack").find("div.SVal").text(SVal);
$(element).parents("div.checkTable").find(":text[@name^='count']").each(function(){
var count_el_v = $(element).val();
var count_one_compl = Math.ceil (count_el_v / SVal_prev);
var count_el_v =count_one_compl * SVal;
$(element).attr("value", count_el_v);
});
}


function toggleAnalogsButton() {
var n = $("input:checked" , $("#featuresA")).length;
if (n > 0) {
$("#AnalogsButton").show();
$("#AnalogsButtonGray").hide();
}
else {
$("#AnalogsButton").hide();
$("#AnalogsButtonGray").show();
}
}


function openPanels(act){
var noact = "L";
var id_act = "jq-panels-left";
if (act == "L"){
noact = "R";
}
else {
id_act = "jq-panels-right";
}
if ( $("#Jq-panel-act" + noact).length ) {
closePanels(noact);
}
if (act == "L"){
$("#"+id_act).parent("td").attr("class", "panel1-actL").next("td").attr("class", "panel2-act").next("td").attr("class", "panel3-actL");
var txtPanel = $("#LeftPanelJq").html();
}
else {
$("#jq-panels-right").parent("td").attr("class", "panel3-actR").prev("td").attr("class", "panel2-act").prev("td").attr("class", "panel1-actR");
var txtPanel = $("#RightPanelJq").html();
}
$("#"+id_act).children("a").attr("class", "block-link green decor-none");

$("body").prepend("<div id='Jq-panel-act"+act+"' class='hiddenPs'><div class='panelF-act"+act+"'>" + txtPanel + "</div>"
+ "<div><img src='/image/brandbook/panelF_bottom.png' width='240' height='12'></div></div>");
var coordPs = $("#jq-panels-left").offset();
$("#Jq-panel-act"+act).css({
'top':coordPs.top + 29, 
'left':coordPs.left, 
'z-index':1000
}).toggleClass("hiddenPs");
}

function closePanels(act){
if (act == "L"){
$("#jq-panels-left").parent("td").attr("class", "panel1").next("td").attr("class", "panel2").next("td").attr("class", "panel3");
$("#jq-panels-left").children("a").attr("class", "block-link white decor-none");
$('#Jq-panel-actL').remove();
clearTimeout(flagcloseID2);
clearTimeout(flagcloseID);
}
else {
$("#jq-panels-right").parent("td").attr("class", "panel3").prev("td").attr("class", "panel2").prev("td").attr("class", "panel1");
$("#jq-panels-right").children("a").attr("class", "block-link white decor-none");
$('#Jq-panel-actR').remove();
clearTimeout(flagcloseID3);
clearTimeout(flagcloseID4);
}
}

function openPanelsComp(elem){

var coordPs;
if ($(elem).prev("td").prev("td").html() == null) {
coordPs = $(elem).offset();
} else {
coordPs = $(elem).prev("td").prev("td").offset();
}

var txtLeftPanel = $("#CompanyPanelJq").html();
$("body").prepend("<div id='Jq-panel-actComp' class='hiddenPs'><div class='panelF-actL'>" + txtLeftPanel + "</div>" + "</div>");
var elemHei = $(elem).height();
$("#Jq-panel-actComp").css({'top':coordPs.top + elemHei, 'left':coordPs.left}).toggleClass("hiddenPs");
}
function closePanelsComp(elem){
$('#Jq-panel-actComp').remove();
}

function autoPer (i, all){
var i2 = i + 1;
advClick (i2, 500);
var i3 = i + 1;
 if (i3 == all) {i3 = 0;}
window.sto_sib = setTimeout("autoPer("+i3+", "+all+")", 6000);
}

function advClick (path, op_val) {

var jj = path - 1;
window.button_adv_reset_pause =jj;

$('#advtopUl ul.bBut').find('img').attr('style', 'margin:1px;visibility: visible;');
$('#advtopUl ul.bBut').find('img').eq(jj).attr('style', 'margin:1px;visibility: hidden;');


var flag_load = $('#thisBnr' + path).find("input[name=js-src-sib]").attr("class");
if (flag_load == 1){
$('#thisBnr' + path).find("input[name=js-src-sib]").attr("class", 0);
var src_sib_val = $('#thisBnr' + path).find("input[name=js-src-sib]").val();
$('#thisBnr' + path).find("img").attr("src",src_sib_val);

}

$('#sib_advtop div.thisBnr:visible').animate({opacity: 0},op_val, function() {
$(this).css("display","none");

$('#thisBnr' + path).css("display","block");
$('#thisBnr' + path).animate({opacity: 1}, 500);
});


}

function DialogResult(){
var htmlTextaeraIns = $("#dialog_error").html();
$("#dialog_error").text(lang[15]);

$("div.ui-dialog-buttonpane").text(" ");
setTimeout(function() {
$("#dialog_error").dialog("destroy");
$("#dialog_error").html(htmlTextaeraIns);
$("input[name='error_input']").val(document.location);
}, 1700);
}

function Ajax_Load_Search(change){
var brand_value = $("#js-brand").val();
var type_value = $("#js-type").val();
var printer_value = $("#js-printer").val();
var layer_html = '<div id="body-blocking-m"></div>'
+ '<div id="parent-blocking-popup-m" align="center">'
+ '<div id="blocking-popup-m">'
+ '<img src="/img/process/wait30trans.gif" width="30" height="30" alt="" border="0">'
+ '</div></div>';
$("body").prepend(layer_html);
$("#js-search-block").load(
"/ajax/get_consum_block.php",
{action:"addsess", change:change, brand:brand_value, type:type_value, printer:printer_value},
function(){$("#body-blocking-m").remove();$("#parent-blocking-popup-m").remove();}
);
}
 

 
function change_banner(direction, bid) {
if (direction == 'left') {
jQuery('#bb' + cur_baner).removeClass('t36_js_number_activ').addClass('t36_js_number_passiv');
cur_baner--;
if (cur_baner < 1) cur_baner = cnt_banner;
} else if (direction == 'right') {
jQuery('#bb' + cur_baner).removeClass('t36_js_number_activ').addClass('t36_js_number_passiv');
cur_baner++;
if (cur_baner > cnt_banner) cur_baner = 1;
} else if(direction == '' && bid != null) {
cur_baner = bid;
jQuery('.t36_js_numbers > ul > li').each(function() {
if (jQuery(this).attr('class') == 't36_js_number_activ') {
jQuery(this).removeClass('t36_js_number_activ').addClass('t36_js_number_passiv');
}
});
}
$('.t36_big_one_banner').animate({
left: -width*(parseInt(cur_baner)-1)
}, speed);
jQuery('#bb' + cur_baner).removeClass('t36_js_number_passiv').addClass('t36_js_number_activ');
jQuery('.t36_link').find('a').attr('href', jQuery('#big_banner_' + cur_baner).find('a').attr('href'));
}

function detectIE6 () {
var browser = navigator.appName;
if (browser == "Microsoft Internet Explorer") {
var b_version = navigator.appVersion;
var re = /\MSIE\s+(\d\.\d\b)/;
var res = b_version.match(re);
if (res[1] <= 6) {
return true;
}
}
return false;
}


function hide_select_in_ie6 () {
if (detectIE6()) {
$('select').addClass('t0_js_hidden_object');
};
}


function show_select_in_ie6 () {
if (detectIE6()) {
$('select').removeClass('t0_js_hidden_object');
};
}


function scroll_page (obj, time) {


if (obj.size() > 0) {


var height_top = obj.offset().top;


if (time) {
$('html, body').animate({scrollTop: height_top}, time);
}

else {
$('html, body').scrollTop(height_top);
}
}
}


function stat_click(i){
$.post("/aload/stat_click/", {type: i});
}

jQuery.fn.popup = function(options){


var options = jQuery.extend({
position: 'nofixed',
autoclose: true,
name: 'default',
closetimeout: 0,
background: '#FFFFFF',
afterClose: function(){}
},options);

this.each(function() {
var input = this;
new jQuery.popup(input, options);
});
return this;
};


jQuery.popup = function(input, options){


var content = jQuery(input).html();


var div1 = "<div id='popup_curtain' style='display:none;'></div>";
var div2 = "<div id='popup_"+options.name+"' style='display:none;'><div id='child_"+options.name+"'>" + content + "</div></div>";
$("body").prepend(div1 + div2);


$("#popup_curtain").css({
"position":"absolute",
"left":0,
"top":0,
"z-index":2100,
"width":"100%",
"text-align":"center",
"background-color":"#FFFFFF",
"opacity":"0.5"
});


$("#popup_"+options.name).css({
"left":0,
"top":0,
"z-index":2200,
"min-width":"300px",
"text-align":"center",
"background-color":options.background
});

if (($.browser.msie) && ($.browser.version == '6.0')) {
 $("#popup_"+options.name).css("position","absolute");
}
else if (options.position == 'fixed'){
 $("#popup_"+options.name).css("position","fixed");
}
else {
 $("#popup_"+options.name).css("position","absolute");
}


if($.browser.msie) {
$('#popup_curtain').height($(document).height()).show();
}
else{
$('#popup_curtain').height($(document).height()).show().fadeTo('slow', 0.7);
}

$("#popup_"+options.name).PopupAlignCenter().show();

if (options.autoclose){
$("#popup_curtain").live("click", function(){
closePopup();
});
}

$(".popup-"+options.name+"-close").live("click", function(){
closePopup();
return false;
});

if (options.closetimeout > 0){
setTimeout(function() { 
closePopup();
}, options.closetimeout);
}

function closePopup(){
$('#popup_curtain').remove();
$('#popup_'+options.name).remove();
options.afterClose();
return false;
}
}


jQuery.fn.PopupAlignCenter = function() {

 var marginLeft = Math.max(40, parseInt($(window).width()/2 - $(this).width()/2)) + 'px';

 var marginTop = Math.max(40, parseInt($(document).scrollTop() + ($(window).height()/2 - $(this).height()/2))) + 'px';

 return $(this).css({'margin-left':marginLeft, 'margin-top':marginTop});
};jQuery.autocomplete=function(g,a){function n(){i={data:{},length:0}}function A(a){var b=$("li",o);b&&(j+=a,0>j?j=0:j>=b.size()&&(j=b.size()-1),b.removeClass("ac_over"),$(b[j]).addClass("ac_over"))}function F(){var c=$("li.ac_over",o)[0];if(!c){var b=$("li",o);a.selectOnly?1==b.length&&(c=b[0]):a.selectFirst&&(c=b[0])}return c?(w(c),!0):!1}function w(c){c||(c=document.createElement("li"),c.extra=[],c.selectValue="");var b=$.trim(c.selectValue?c.selectValue:c.innerHTML);p=g.lastSelected=b;l.html("");f.val(b);q();a.onItemSelect&&setTimeout(function(){a.onItemSelect(c)},1)}function q(){m&&clearTimeout(m);f.removeClass(a.loadingClass);l.is(":visible")&&l.hide();a.mustMatch&&f.val()!=g.lastSelected&&w(null)}function B(c){if(!c)return null;for(var b=[],c=c.split(a.lineSeparator),d=0;d<c.length;d++){var e=$.trim(c[d]);e&&(b[b.length]=e.split(a.cellSeparator))}return b}function G(c){var b=document.createElement("ul"),d=c.length;0<a.maxItemsToShow&&a.maxItemsToShow<d&&(d=a.maxItemsToShow);for(var e=0;e<d;e++){var k=c[e];if(k){var h=document.createElement("li");h.innerHTML=a.formatItem?a.formatItem(k,e,d):k[0];h.selectValue=k[0];var f=null;if(1<k.length)for(var f=[],g=1;g<k.length;g++)f[f.length]=k[g];h.extra=f;b.appendChild(h);$(h).hover(function(){$("li",b).removeClass("ac_over");$(this).addClass("ac_over");j=$("li",b).indexOf($(this).get(0))},function(){$(this).removeClass("ac_over")}).click(function(a){a.preventDefault();a.stopPropagation();w(this)})}}return b}function H(c){a.matchCase||(c=c.toLowerCase());a.cacheLength&&C(c);"string"==typeof a.url&&0<a.url.length?$.get(D(c),function(b){var d,b=B(b);x(c,b);d=c;if(b)if(f.removeClass(a.loadingClass),o.innerHTML="",!y||0==b.length)q();else{o.appendChild(G(b));if(a.autoFill&&f.val().toLowerCase()==d.toLowerCase()&&(b=b[0][0],8!=r)){f.val(f.val()+b.substring(p.length));d=p.length;var b=b.length,e=f.get(0);if(e.createTextRange){var k=e.createTextRange();k.collapse(!0);k.moveStart("character",d);k.moveEnd("character",b);k.select()}else e.setSelectionRange?e.setSelectionRange(d,b):e.selectionStart&&(e.selectionStart=d,e.selectionEnd=b);e.focus()}d=g;e=d.offsetLeft||0;for(b=d.offsetTop||0;d=d.offsetParent;)e+=d.offsetLeft,b+=d.offsetTop;d=e;e=0<a.width?a.width:f.width();l.css({width:parseInt(e)+"px",top:b+g.offsetHeight+3+"px",left:d-8+"px"}).show()}else q()}):f.removeClass(a.loadingClass)}function D(c){var c=a.url+"?q="+encodeURI(c),b;var par='';for(b in a.extraParams){if(typeof(a.extraParams[b])!=='function'){par=a.extraParams[b];}else{par=a.extraParams[b]();}c+="&"+b+"="+encodeURI(par);}return c}function C(c){if(!c)return null;if(i.data[c])return i.data[c];if(a.matchSubset)for(var b=c.length-1;b>=a.minChars;b--){var d=c.substr(0,b);if(d=i.data[d]){for(var b=[],e=0;e<d.length;e++){var f=d[e],h;h=f[0];var g=c;a.matchCase||(h=h.toLowerCase());h=h.indexOf(g);h=-1==h?!1:0==h||a.matchContains;h&&(b[b.length]=f)}return b}}return null}function z(c,b){b&&f.removeClass(a.loadingClass);for(var d=b?b.length:0,e=null,g=0;g<d;g++){var h=b[g];if(h[0].toLowerCase()==c.toLowerCase()){e=document.createElement("li");e.innerHTML=a.formatItem?a.formatItem(h,g,d):h[0];e.selectValue=h[0];var i=null;if(1<h.length)for(var i=[],j=1;j<h.length;j++)i[i.length]=h[j];e.extra=i}}a.onFindValue&&setTimeout(function(){a.onFindValue(e)},1)}function x(c,b){b&&c&&a.cacheLength&&(!i.length||i.length>a.cacheLength?(n(),i.length++):i[c]||i.length++,i.data[c]=b)}var f=$(g).attr("autocomplete","off");a.inputClass&&f.addClass(a.inputClass);var o=document.createElement("div"),l=$(o);l.hide().addClass(a.resultsClass).css("position","absolute");0<a.width&&l.css("width",a.width);$("body").append(o);g.autocompleter=this;var m=null,p="",j=-1,i={},y=!1,r=null;n();if(null!=a.data){var u="",s={},v=[];"string"!=typeof a.url&&(a.cacheLength=1);for(var t=0;t<a.data.length;t++)v="string"==typeof a.data[t]?[a.data[t]]:a.data[t],0<v[0].length&&(u=v[0].substring(0,1).toLowerCase(),s[u]||(s[u]=[]),s[u].push(v));for(var E in s)a.cacheLength++,x(E,s[E])}f.keydown(function(c){r=c.keyCode;switch(c.keyCode){case 38:c.preventDefault();A(-1);break;case 40:c.preventDefault();A(1);break;case 9:case 13:F()&&(f.get(0).blur(),c.preventDefault());break;default:j=-1,m&&clearTimeout(m),m=setTimeout(function(){if(46==r||8<r&&32>r)l.hide();else{var b=f.val();b!=p&&(p=b,b.length>=a.minChars?(f.addClass(a.loadingClass),H(b)):(f.removeClass(a.loadingClass),l.hide()))}},a.delay)}}).focus(function(){y=!0}).blur(function(){y=!1;m&&clearTimeout(m);m=setTimeout(q,200)});q();this.flushCache=function(){n()};this.setExtraParams=function(c){a.extraParams=c};this.findValue=function(){var c=f.val();a.matchCase||(c=c.toLowerCase());var b=a.cacheLength?C(c):null;b?z(c,b):"string"==typeof a.url&&0<a.url.length?$.get(D(c),function(a){a=B(a);x(c,a);z(c,a)}):z(c,null)}};jQuery.fn.autocomplete=function(g,a,n){a=a||{};a.url=g;a.data="object"==typeof n&&n.constructor==Array?n:null;a.inputClass=a.inputClass||"ac_input";a.resultsClass=a.resultsClass||"ac_results";a.lineSeparator=a.lineSeparator||"\n";a.cellSeparator=a.cellSeparator||"|";a.minChars=a.minChars||1;a.delay=a.delay||400;a.matchCase=a.matchCase||0;a.matchSubset=a.matchSubset||1;a.matchContains=a.matchContains||0;a.cacheLength=a.cacheLength||1;a.mustMatch=a.mustMatch||0;a.extraParams=a.extraParams||{};a.loadingClass=a.loadingClass||"ac_loading";a.selectFirst=a.selectFirst||!1;a.selectOnly=a.selectOnly||!1;a.maxItemsToShow=a.maxItemsToShow||-1;a.autoFill=a.autoFill||!1;a.width=parseInt(a.width,10)||0;this.each(function(){new jQuery.autocomplete(this,a)});return this};jQuery.fn.autocompleteArray=function(g,a){return this.autocomplete(null,a,g)};jQuery.fn.indexOf=function(g){for(var a=0;a<this.length;a++)if(this[a]==g)return a;return-1};$(document).ready(function(){$("#query_ac_main").autocomplete("/ajax/autocomplete.php",{delay:10,lineSeparator:"---",minChars:1,matchSubset:1,autoFill:!1,matchContains:1,cacheLength:1,selectFirst:!1,maxItemsToShow:10,onItemSelect:function(){$("#query_ac_main").focus()}})});